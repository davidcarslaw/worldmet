---
title: "Using {worldmet} to Locate, Import & Visualise Meteorological Data"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(worldmet)
```

# Show all sites

The function to use to find which sites are available is `getMeta()`. By default, it returns a table of site metadata, which could be searched using R's `View()` function.

```{r getmeta}
getMeta()
```

Perhaps more usefully, if you have the `{leaflet}` package installed you could instead recieve this as an interactive map. Click to expand the markers until you find the site of interest (shown by a blue marker). This reveals some site information including the site name and the start and end date of available data. The most important information revealed in the marker is the code, which is used to access the data.

```{r getmeta_map, out.width="100%"}
worldmet::getMeta(return = "map")
```

# Search based on latitude and longitude

Often, one has an idea of the region in which a site is of interest. For example, if the interest was in sites close to London, the latitude and longitude can be supplied and a search is carried out of the 10 nearest sites to that location. There is also an option, `n`, that can be used in change the number of nearest sites shown. If a lat/lon is provided, clicking on the blue marker will show the approximate distance between the site and the search coordinates.

```{r getmeta2, out.width="100%"}
getMeta(lat = 51.5, lon = 0, return = "map")
```

# Importing Data

To obtain the data the user must supply a `code` (see above) and year(s) of interest. For example, to download data for Heathrow Airport in 2010 (code 037720-99999):

```{r import}
met_london <- importNOAA(code = "037720-99999", year = 2010)
head(met_london)
```

A wind rose (for example) can easily be plotted using `openair`:

```{r}
# load openair
openair::windRose(met_london)
```
